namespace = mymo

mymo.1 = { # Fill all the monastery courts which are empty
	hidden = yes

	immediate = {
		every_realm_province = {
			limit = {
				has_holding_type = monastery_holding
				province_owner = {
					any_courtier = {
						has_monastic_trigger = yes
						count = 0
					}
				}
			}
			save_scope_as = monastery_province
			create_character = {
				template = monk_character
				employer = scope:monastery_province.province_owner
				culture = scope:monastery_province.culture
				faith = scope:monastery_province.faith
				after_creation = {
					add_character_flag = blocked_from_leaving
				}
			}			
		}
		#young monk or old monk
		random_list = {
			50 = {
				every_realm_province = {
					limit = {
						has_holding_type = monastery_holding
						province_owner = {
							any_courtier = {
								has_monastic_trigger = yes
								count <= 3
							}
						}
					}
					save_scope_as = monastery_province
					create_character = {
						template = monk_novice_character
						employer = scope:monastery_province.province_owner
						culture = scope:monastery_province.culture
						faith = scope:monastery_province.faith
						after_creation = {
							add_character_flag = blocked_from_leaving
						}
					}			
				}
			}
			50 = {
				every_realm_province = {
					limit = {
						has_holding_type = monastery_holding
						province_owner = {
							any_courtier = {
								has_monastic_trigger = yes
								count <= 3
							}
						}
					}
					save_scope_as = monastery_province
					create_character = {
						template = monk_older_character
						employer = scope:monastery_province.province_owner
						culture = scope:monastery_province.culture
						faith = scope:monastery_province.faith
						after_creation = {
							add_character_flag = blocked_from_leaving
						}
					}			
				}
			}
		}
		#broader monk profile as second choice
		every_realm_province = {
			limit = {
				has_holding_type = monastery_holding
				province_owner = {
					any_courtier = {
						has_monastic_trigger = yes
						count <= 3
					}
				}
			}
			save_scope_as = monastery_province
			create_character = {
				template = monk_broader_character
				employer = scope:monastery_province.province_owner
				culture = scope:monastery_province.culture
				faith = scope:monastery_province.faith
				after_creation = {
					add_character_flag = blocked_from_leaving
				}
			}			
		}
		#generic monk for third one
		every_realm_province = {
			limit = {
				has_holding_type = monastery_holding
				province_owner = {
					any_courtier = {
						has_monastic_trigger = yes
						count <= 3
					}
				}
			}
			save_scope_as = monastery_province
			create_character = {
				template = monk_character
				employer = scope:monastery_province.province_owner
				culture = scope:monastery_province.culture
				faith = scope:monastery_province.faith
				after_creation = {
					add_character_flag = blocked_from_leaving
				}
			}			
		}
	}
}

mymo.2 = { # Remove monk title (on_leave_court)
	hidden = yes

	immediate = {
		if = {
			limit = {
				any_relation = {
					type = monastery_liege
					this = scope:old_employer
				}	
			}
			remove_relation_monastery_liege = scope:old_employer
		}
		scope:old_employer = {
			if = {
				limit = {
					any_relation = {
						type = monastery_prior
						this = root
					}	
				}
				remove_relation_monastery_prior = root
			}
			if = {
				limit = {
					any_relation = {
						type = monastery_cantor
						this = root
					}	
				}
				remove_relation_monastery_cantor = root
			}
			if = {
				limit = {
					any_relation = {
						type = monastery_elder
						this = root
					}	
				}
				remove_relation_monastery_elder = root
			}
			if = {
				limit = {
					any_relation = {
						type = monastery_cellarer
						this = root
					}	
				}
				remove_relation_monastery_cellarer = root
			}
		}
	}
}
	